
// This file has been autogenerated by configure.py please modify config_*.py
// files and run configure.py instead of modifying this file.

#ifndef COMMUNICATION_H_
#define COMMUNICATION_H_

#include <stdint.h>
#include "array.hpp"

typedef uint8_t Address_t;

typedef enum : Address_t {
	COM_ADDRESS_ROOTER     = 0x00,
	COM_ADDRESS_COMPUTER   = 0x01,
	COM_ADDRESS_CLOCK      = 0x02,
	COM_ADDRESS_PUZZLE1    = 0x03,
	COM_ADDRESS_PUZZLE2    = 0x04
} com_Address_e;

typedef struct {
	uint8_t dest;
	uint8_t src;
	uint8_t data[14];
} Packet_t;


class Communication {
public:
	Address_t src;

	Communication(Address_t src);
	
	// Get new packets in input queue and return nb of packets in input queue.
	unsigned char fetchPackets(void);

	// return nb of packets in input queue.
	unsigned char available(void);

	// get packet from input queue.
	Packet_t get(void);

	// add packet to output queue. Return nb of packets in output queue
	unsigned char send(const Packet_t* packet);

	// send output queue (may take a while).
	void flush(void);

};

#endif
